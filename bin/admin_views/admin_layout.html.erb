<!DOCTYPE html>
<html lang="<%= @hyde_parameters['hyde_admin_language'] %>">
  <head>
    <meta charset="utf-8">
    <title>Hyde for Jekyll</title>

    <meta name="description" content="Hyde for Jekyll">
    <meta name="author" content="Sylvain Claudel (https://blog.rivsc.ovh)">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">

    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.1.1/dist/css/bootstrap.min.css" rel="stylesheet" integrity="sha384-F3w7mX95PdgyTmZZMECAngseQB83DfGTowi0iMjiWaeVhAn4FJkqJByhZMI3AhiU" crossorigin="anonymous">
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.1.1/dist/js/bootstrap.bundle.min.js" integrity="sha384-/bQdsTh/da6pkI1MST/rWKFNjaCP5gBSY4sEBT38Q/9RBh9AH40zEOg7Hlq2THRZ" crossorigin="anonymous"></script>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.4/css/all.min.css" integrity="sha512-1ycn6IcaQQ40/MKBW2W4Rhis/DbILU74C1vSrLJxCq57o941Ym01SwNsOMqvEBFlcgUa6xLiPY/NS5R+E6ztJQ==" crossorigin="anonymous" referrerpolicy="no-referrer" />

    <script src="/lib/codemirror.js"></script>
    <link rel="stylesheet" href="/lib/codemirror.css">
    <script src="/mode/javascript/javascript.js"></script>
    <script src="/mode/css/css.js"></script>
    <script src="/mode/sass/sass.js"></script>
    <script src="/mode/ruby/ruby.js"></script>
    <script src="/mode/yaml/yaml.js"></script>
    <script src="/mode/xml/xml.js"></script>
    <script src="/mode/markdown/markdown.js"></script>
    <script src="https://code.jquery.com/jquery-3.6.0.min.js" integrity="sha256-/xUj+3OJU5yExlq6GSYGSHk7tPXikynS7ogEvDej/m4=" crossorigin="anonymous"></script>

    <link rel="stylesheet" href="/hyde_assets/hyde_admin.css">
    <script src="/hyde_assets/hyde_admin.js"></script>
  </head>
  <body>
    <div class="container-fluid">
      <div class="row">
        <nav id="sidebarMenu" class="col-md-3 col-lg-2 d-md-block bg-light sidebar collapse">
          <div class="position-sticky pt-3">
            <ul class="nav flex-column">
              <li class="nav-item">
                <a class="nav-link active" aria-current="page" href="/<%= @hyde_parameters['site_index'] %>">
                  <span data-feather="home" class="fas fa-eye"></span>
                  <%= t.overview.capitalize %>
                </a>
              </li>
              <li class="nav-item">
              </li>
              <li class="nav-item">
                <a class="nav-link active" aria-current="page" href="/dashboard">
                  <span data-feather="home" class="fas fa-tachometer-alt"></span>
                  <%= t.dashboard.capitalize %>
                </a>
              </li>
              <li class="nav-item">
                <a class="nav-link" href="/pages/index">
                  <span data-feather="file" class="fas fa-file"></span>
                  <%= t.pages.capitalize %>
                </a>
              </li>
              <li class="nav-item">
                <a class="nav-link" href="/drafts/index">
                  <span data-feather="shopping-cart" class="fas fa-file"></span>
                  <%= t.drafts.capitalize %>
                </a>
              </li>
              <li class="nav-item">
                <a class="nav-link" href="/posts/index">
                  <span data-feather="users" class="fas fa-file"></span>
                  <%= t.posts.capitalize %>
                </a>
              </li>
              <li class="nav-item"></li>
              <li class="nav-item">
                <a class="nav-link" href="/files/index">
                  <span data-feather="users" class="fas fa-copy"></span>
                  <%= t.files.capitalize %>
                </a>
              </li>
              <li class="nav-item"></li>
              <li class="nav-item">
                <a class="nav-link active" aria-current="page" href="/rebuild" id="btn-rebuild">
                  <span data-feather="home" class="fas fa-hammer"></span>
                  <%= t.rebuild.capitalize %>
                </a>
              </li>
              <li class="nav-item">
                <a class="nav-link active" aria-current="page" href="/deploy" id="btn-deploy">
                  <span data-feather="home" class="fas fa-cloud-upload-alt"></span>
                  <%= t.deploy.capitalize %>
                </a>
              </li>
              <li class="nav-item"></li>
              <li class="nav-item">
                <a class="nav-link" href="/configuration">
                  <span data-feather="layers" class="fas fa-tools"></span>
                  <%= t.configuration.capitalize %>
                </a>
              </li>
            </ul>
            <p class="text-center text-muted"><br><br><em>Hyde Admin V.<%= HydeAdmin::VERSION %></em>&nbsp;&nbsp;&nbsp;<a href="https://github.com/rivsc/hyde_admin" class="link-secondary"><i class="fab fa-github"></i></a></p>
          </div>
        </nav>
        <main class="col-md-9 ms-sm-auto col-lg-10 px-md-4">
          <div class="d-flex justify-content-between flex-wrap flex-md-nowrap align-items-center pt-3 pb-2 mb-3 border-bottom">
            <h1 class="h2">Hyde Admin for Jekyll</h1>
            <!--
            <div class="btn-toolbar mb-2 mb-md-0">
              <div class="btn-group me-2">
                <button type="button" class="btn btn-sm btn-outline-secondary"><%= t.backup_zip %></button>
                <button type="button" class="btn btn-sm btn-outline-secondary">Export</button>
              </div>
              <button type="button" class="btn btn-sm btn-outline-secondary dropdown-toggle">
                <span data-feather="calendar"></span>
                This week
              </button>
            </div>
            -->
          </div>
          <%= yield %>
        </main>
      </div>
    </div>

    <div id="waiting" style="width:100vw;height:100vh;display:none;text-align:center;background-color:rgba(0,0,0,0.5);position: fixed;top:0px;left:0px">
      <i class="fas fa-circle-notch fa-10x fa-spin" style="margin-top:40vh;"></i>
    </div>

    <div class="modal modal-image" tabindex="-1" role="dialog">
      <div class="modal-dialog" role="document">
        <div class="modal-content">
          <div class="modal-header">
            <h5 class="modal-title">Images</h5>
            <button type="button" class="close" data-dismiss="modal" aria-label="Close">
              <span aria-hidden="true">&times;</span>
            </button>
          </div>
          <div class="modal-body modal-body-image">
            <% path_of_images = File.join(Dir.pwd, @hyde_parameters['images_path'], "**") %>
            <% $stderr.puts(path_of_images) %>
            <% Dir.glob(path_of_images)[(@page || 0) * 9, ((@page || 0) + 1) * 9 ].each do |img| %>
              <% img = img.gsub(Dir.pwd, "") %>
              <div class="image-element">
                <img src="<%= img %>" alt="<%= img %>">
              </div>
            <% end %>
          </div>
        </div>
      </div>
    </div>

    <script type="text/javascript" charset="utf-8">
      <% if @file %>
      if(window.document.getElementById('i-content')){
          window.myCodeMirror = CodeMirror.fromTextArea(window.document.getElementById('i-content'), {
            lineNumbers: true,
            tabSize: 2,
            indentWithTabs: false,
            mode: "<%= {'.js' => 'javascript', '.json' => 'javascript', '.xml' => 'xml', '.svg' => 'xml', '.css' => 'css', '.yml' => 'yaml', '.sass' => 'sass', '.rb' => 'ruby', '.md' => 'markdown'}[File.extname(@file)] || 'markdown' %>"
        });
      }
      <% end %>
    </script>
    <script src="/fslightbox/fslightbox.js"></script>
  </body>
</html>
