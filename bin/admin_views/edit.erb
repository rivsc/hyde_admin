<h2><%= t.send(@type_file).capitalize %></h2>

<% new_record = @file.empty? %>

<% file = (!new_record ? "?file=#{@file}" : "") %>

<form action="/<%= @type_file %><%= file %>" method="post">
  <input type="hidden" name="old_path" value="<%= file %>">
  <div class="mb-3">
    <label for="i-path" class="form-label"><%= t.path.capitalize %></label>
    <div class="input-group">
      <input type="text" class="form-control" value="<%= @file %>" name="new_file" id="i-path">
      <span class="input-group-text">
        <i class="fas fa-calendar-alt" id="btn-date-path" title="<%= t.change_date_path %>"></i>
      </span>
      <span class="input-group-text">
        <i class="fas fa-sync-alt" id="btn-title-path" title="<%= t.change_title_path %>"></i>
      </span>
    </div>
    <div id="i-path-help" class="form-text"><%= t.help_path %></div>
  </div>  
  <div class="mb-3">
    <label for="i-title" class="form-label"><%= t.title.capitalize %></label>
    <input type="text" value="<%= @headers['title'] %>" class="form-control" name="title" id="i-title">
  </div>
  <div class="mb-3">
    <label for="i-date" class="form-label"><%= t.date.capitalize %></label>
    <div class="input-group">
      <input type="text" value="<%= @headers['date'] %>" class="form-control" name="date" id="i-date">
      <span class="input-group-text">
        <i class="fas fa-calendar-day" id="btn-date-today" title="<%= t.set_date_today %>"></i>
      </span>
    </div>
  </div>
  <div class="mb-3">
    <label for="i-tags" class="form-label"><%= t.tags.capitalize %></label>
    <input type="text" value="<%= @headers['tags'] %>" class="form-control" name="tags" id="i-tags">
    <div id="i-tags-help" class="form-text"><%= t.help_tags %></div>
  </div>
  <div class="mb-3 form-check">
    <input type="checkbox" class="form-check-input" name="publish" id="i-publish">
    <label class="form-check-label" for="i-publish"><%= t.publish.capitalize %></label>
  </div>

  <div class="mb-3">
    <label for="i-layout" class="form-label"><%= t.layout.capitalize %></label>
    <select class="form-select" aria-label="Choice layout" name="layout">
      <% Dir.glob(File.join(Dir.pwd, '_layouts', '*')).each do |f| %>
        <% layout = File.basename(f, File.extname(f)) %>
        <option <%= (@headers['layout'] == f ? 'selected' : '') %> value="<%= layout %>"><%= layout %></option>
      <% end %>
    </select>
  </div>

  <div class="mb-3">
    <label for="i-content" class="form-label"><%= t.content.capitalize %></label>
    <textarea class="form-control text-editor" id="i-content" rows="3" name="content"><%= @content %></textarea>
  </div>

<!--
  <div class="form-check">
    <input class="form-check-input" type="checkbox" value="" id="flexCheckDefault">
    <label class="form-check-label" for="flexCheckDefault">
      Default checkbox
    </label>
  </div>
  <div class="form-check">
    <input class="form-check-input" type="checkbox" value="" id="flexCheckChecked" checked>
    <label class="form-check-label" for="flexCheckChecked">
      Checked checkbox
    </label>
  </div>
-->
  <button type="submit" class="btn btn-primary"><%= t.submit.capitalize %></button>
</form>

<script type="text/javascript" charset="utf-8">
    $(document).on('click', '#btn-date-path', function(){
        $.post( "/ajax/update_path_date", { date: $('#i-date').val(), path: $('#i-path').val() })
            .done(function( data ) {
                $('#i-path').val(data);
            });
    });
    $(document).on('click', '#btn-title-path', function(){
        $.post( "/ajax/update_path_title", { title: $('#i-title').val(), path: $('#i-path').val() })
            .done(function( data ) {
                $('#i-path').val(data);
            });
    });

    $(document).on('click', '#btn-date-today', function(){
        $.post( "/ajax/update_date_today", {})
            .done(function( data ) {
                $('#i-date').val(data);
            });
    });
</script>
